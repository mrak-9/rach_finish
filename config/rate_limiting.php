<?php

return [
    /*
    |--------------------------------------------------------------------------
    | Rate Limiting Configuration
    |--------------------------------------------------------------------------
    |
    | Настройки ограничения частоты запросов для различных типов операций
    |
    */

    'api' => [
        'default' => 60, // запросов в минуту для обычных API запросов
        'write' => 10,   // запросов в минуту для операций записи
        'sensitive' => 5, // запросов в минуту для чувствительных операций
        'auth' => 30,    // запросов в минуту для авторизованных пользователей
        'admin' => 3,    // запросов в минуту для административных операций
    ],

    'web' => [
        'forms' => 20,           // отправок форм в минуту
        'file_upload' => 5,      // загрузок файлов в 10 минут
        'search' => 100,         // поисковых запросов в минуту
        'event_registration' => [
            'per_ip' => 10,      // регистраций в час по IP
            'per_user' => 5,     // регистраций в час по пользователю
        ],
        'email_sending' => 5,    // отправок email в час
    ],

    'auth' => [
        'login' => [
            'per_email' => 5,    // попыток входа в минуту по email
            'per_ip' => 10,      // попыток входа в минуту по IP
        ],
        'password_reset' => 3,   // запросов на восстановление пароля в час
        'registration' => 20,    // регистраций в минуту (защита от спама)
    ],

    'ddos_protection' => [
        'enabled' => env('DDOS_PROTECTION_ENABLED', true),
        'max_requests_per_minute' => 200,
        'max_same_requests' => 50,
        'max_404_requests_per_hour' => 20,
        'suspicious_user_agents' => [
            'curl', 'wget', 'python', 'bot', 'crawler', 'spider',
            'scraper', 'scanner', 'test', 'benchmark'
        ],
        'allowed_bots' => [
            'googlebot', 'bingbot', 'yandexbot', 'facebookexternalhit'
        ],
    ],

    'messages' => [
        'api_limit' => 'Превышен лимит запросов. Попробуйте позже.',
        'api_write_limit' => 'Превышен лимит для операций записи. Попробуйте через минуту.',
        'api_sensitive_limit' => 'Превышен лимит для чувствительных операций. Попробуйте через несколько минут.',
        'api_auth_limit' => 'Превышен лимит запросов для авторизованных пользователей.',
        'api_admin_limit' => 'Превышен лимит для административных операций.',
        'web_forms_limit' => 'Превышен лимит отправки форм. Попробуйте через минуту.',
        'file_upload_limit' => 'Превышен лимит загрузки файлов. Попробуйте через 10 минут.',
        'search_limit' => 'Превышен лимит поисковых запросов.',
        'email_limit' => 'Превышен лимит отправки email. Попробуйте через час.',
        'login_limit' => 'Слишком много попыток входа. Попробуйте позже.',
        'password_reset_limit' => 'Превышен лимит запросов на восстановление пароля. Попробуйте через час.',
        'ddos_protection' => 'Доступ временно ограничен из-за подозрительной активности.',
    ],

    /*
    |--------------------------------------------------------------------------
    | Cache Store
    |--------------------------------------------------------------------------
    |
    | Хранилище для rate limiting. Рекомендуется использовать Redis
    | для лучшей производительности в продакшене.
    |
    */
    'cache_store' => env('RATE_LIMIT_CACHE_STORE', 'redis'),

    /*
    |--------------------------------------------------------------------------
    | Logging
    |--------------------------------------------------------------------------
    |
    | Настройки логирования для rate limiting и DDoS защиты
    |
    */
    'logging' => [
        'enabled' => env('RATE_LIMIT_LOGGING', true),
        'channel' => env('RATE_LIMIT_LOG_CHANNEL', 'daily'),
        'log_high_activity_threshold' => 100, // логировать активность выше этого порога
    ],

    /*
    |--------------------------------------------------------------------------
    | Whitelist
    |--------------------------------------------------------------------------
    |
    | IP адреса, которые исключены из rate limiting
    |
    */
    'whitelist' => [
        // '127.0.0.1',
        // '::1',
    ],

    /*
    |--------------------------------------------------------------------------
    | Blacklist
    |--------------------------------------------------------------------------
    |
    | IP адреса, которые полностью заблокированы
    |
    */
    'blacklist' => [
        // Добавьте сюда IP адреса для блокировки
    ],
];